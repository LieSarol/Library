<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Analyzing...</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      background: radial-gradient(ellipse at center, #0a0a23 0%, #000010 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #c0caff;
      font-family: 'Segoe UI', sans-serif;
      font-size: 20px;
      overflow: hidden;
    }

    .loader {
      display: flex;
      flex-direction: column;
      align-items: center;
      animation: fadeIn 1s ease-in-out;
    }

    .dot-flash {
      display: flex;
      gap: 8px;
      margin-top: 12px;
    }

    .dot-flash div {
      width: 10px;
      height: 10px;
      background: #c0caff;
      border-radius: 50%;
      animation: pulse 1s infinite ease-in-out;
    }

    .dot-flash div:nth-child(2) {
      animation-delay: 0.2s;
    }

    .dot-flash div:nth-child(3) {
      animation-delay: 0.4s;
    }

    @keyframes pulse {
      0%, 80%, 100% { transform: scale(0.6); opacity: 0.4; }
      40% { transform: scale(1); opacity: 1; }
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body>
  <div class="loader">
    <div>Analyzing your question...</div>
    <div class="dot-flash">
      <div></div><div></div><div></div>
    </div>
  </div>

  <script>
    const CATEGORIES = [
      "Language Learning", "Mathematics", "Science", "Technology", "Engineering", "Art",
      "Music", "History", "Geography", "Philosophy", "Psychology", "Literature",
      "Writing & Communication", "Business & Entrepreneurship", "Finance & Investing", "Economics",
      "Marketing", "Sales", "Public Speaking", "Critical Thinking", "Coding / Programming",
      "Graphic Design", "Web Development", "App Development", "Game Development", "Animation",
      "Video Production", "Photography", "Data Science", "Artificial Intelligence", "Cybersecurity",
      "Robotics", "Mechanics / Auto Repair", "Architecture", "Interior Design", "Fashion Design",
      "Cooking & Culinary Arts", "Baking", "Fitness & Exercise", "Yoga & Mindfulness",
      "Health & Nutrition", "Self-Improvement", "Time Management", "Parenting Skills",
      "Foreign Cultures & Travel", "Astronomy", "Biology", "Chemistry", "Physics", "Environmental Studies"
    ];

    const query = sessionStorage.getItem('searchQuery') || '';

    const prompt = `
Classify the following question into ONE of the categories below. ONLY return the category name exactly as written:

Categories:
${CATEGORIES.map((c, i) => `${i + 1}. ${c}`).join('\n')}

Question: "${query}"
Category:
`;

    fetch('https://library-of-knowledge.vercel.app/groq', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ message: prompt })
    })
    .then(res => res.json())
    .then(data => {
      const reply = data.choices?.[0]?.message?.content?.trim();
      if (reply) {
        sessionStorage.setItem('nicheQuery', reply);
      }
    })
    .finally(() => {
      window.location.href = 'search-page.html';
    });
  </script>
</body>
</html>
