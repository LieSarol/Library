<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Detecting Niche...</title>
  <script defer>
    window.addEventListener('DOMContentLoaded', async () => {
      const searchQuery = sessionStorage.getItem('searchQuery');

      if (!searchQuery) {
        alert("No search query found in sessionStorage!");
        return;
      }

      const optionsList = `
1. Language Learning
2. Mathematics
3. Science
4. Technology
5. Engineering
6. Art
7. Music
8. History
9. Geography
10. Philosophy
11. Psychology
12. Literature
13. Writing & Communication
14. Business & Entrepreneurship
15. Finance & Investing
16. Economics
17. Marketing
18. Sales
19. Public Speaking
20. Critical Thinking
21. Coding / Programming
22. Graphic Design
23. Web Development
24. App Development
25. Game Development
26. Animation
27. Video Production
28. Photography
29. Data Science
30. Artificial Intelligence
31. Cybersecurity
32. Robotics
33. Mechanics / Auto Repair
34. Architecture
35. Interior Design
36. Fashion Design
37. Cooking & Culinary Arts
38. Baking
39. Fitness & Exercise
40. Yoga & Mindfulness
41. Health & Nutrition
42. Self-Improvement
43. Time Management
44. Parenting Skills
45. Foreign Cultures & Travel
46. Astronomy
47. Biology
48. Chemistry
49. Physics
50. Environmental Studies
`;

      const systemPrompt = `
You are a niche classifier. Given a user's search query, classify it into 1 to 3 of the most relevant niches from this list:
${optionsList}

Only return the names of the top 1-3 matching niches. Be accurate, short, and clear.
`;

      try {
        const response = await fetch('https://library-of-knowledge.vercel.app/groq', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
  messages: [
    {
      role: "user",
      content: `Given the following query: "${searchQuery}"
Which of these niches does it belong to? List 1 to 3 max. Only give the niche names and nothing else:

${optionsList}`
    }
  ],
  model: 'meta-llama/llama-4-scout-17b-16e-instruct'
})
        });

        const data = await response.json();
        const aiReply = data?.choices?.[0]?.message?.content;

        if (!aiReply) {
          throw new Error("No niche response from Groq.");
        }

        sessionStorage.setItem('nicheQuery', aiReply.trim());
        window.location.href = 'search-page.html';
      } catch (error) {
        console.error("Groq failed:", error);
        alert("Failed to detect niche. Try again later!");
      }
    });
  </script>
</head>
<body>
  <h1>Detecting your niche... üîç</h1>
  <p>Hang tight, we‚Äôre interrogating the AI ü§ñ</p>
</body>
</html>
