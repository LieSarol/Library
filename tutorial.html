<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Niche Playlist</title>

  <!-- TailwindCSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Font Awesome for Back Icon -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />

  <style>
    body {
      background-color: #1E293B;
      color: white;
      font-family: 'Arial', sans-serif;
    }

    .btn-blue {
      background-color: #2563ea;
    }

    .btn-blue:hover {
      background-color: #1e4cd4;
    }

    .playlist-item:hover {
      box-shadow: 0 0 10px rgba(37, 99, 234, 0.3);
      transform: scale(1.02);
    }
  </style>
</head>
<body class="min-h-screen p-4">

  <!-- Back Button -->
  <div class="mb-6">
    <button onclick="history.back()" class="text-white text-xl hover:text-blue-400">
      <i class="fas fa-arrow-left"></i> Back
    </button>
  </div>

  <!-- Thumbnail -->
  <div class="mb-6 w-full max-w-3xl mx-auto rounded-lg overflow-hidden">
    <img src="https://cdn.pixabay.com/photo/2025/05/30/17/16/mountain-9631830_1280.jpg" alt="Thumbnail"
         class="w-full h-auto object-cover rounded">
  </div>

  <!-- Playlist Items -->
  <div id="playlist" class="space-y-4 max-w-3xl mx-auto"></div>

  <script>
    function getCookieValue(name) {
      const value = `; ${document.cookie}`;
      const parts = value.split(`; ${name}=`);
      if (parts.length === 2) return parts.pop().split(';').shift();
    }

    async function fetchPlaylist() {
      const niche = getCookieValue("niche1");
      const playlist = document.getElementById("playlist");

      if (!niche) {
        playlist.innerHTML = "<p class='text-red-400'>Cookie 'niche1' not set.</p>";
        return;
      }

      try {
        const res = await fetch(`/data/niche/${encodeURIComponent(niche)}?limit=20`);
        const data = await res.json();

        if (!Array.isArray(data) || data.length === 0) {
          playlist.innerHTML = "<p class='text-yellow-400'>No results found for this niche.</p>";
          return;
        }

        playlist.innerHTML = "";

        data.forEach(item => {
          const div = document.createElement("a");
          div.href = "main.html";
          div.className = "block playlist-item bg-slate-800 p-4 rounded-lg transition duration-200 hover:cursor-pointer";

          div.innerHTML = `
            <h3 class="text-lg font-medium">${item.question || "Untitled question"}</h3>
          `;

          playlist.appendChild(div);
        });
      } catch (err) {
        console.error(err);
        playlist.innerHTML = `<p class="text-red-500">Error fetching data: ${err.message}</p>`;
      }
    }

    fetchPlaylist();
  </script>
</body>
</html>
